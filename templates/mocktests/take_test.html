<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam in Progress - {{ test.item.title }}</title>
    {% load static %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(', '\\)'], ['$', '$']], displayMath: [['$$', '$$'], ['\\[', '\\]']] },
      svg: { fontCache: 'global' }
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        body { background-color: #f4f6f8; height: 100vh; overflow: hidden; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; user-select: none; }
        
        /* --- Header --- */
        .exam-header { height: 60px; background: white; border-bottom: 1px solid #e0e0e0; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .system-status { display: flex; align-items: center; gap: 15px; font-size: 0.85rem; color: #6c757d; border-right: 1px solid #dee2e6; padding-right: 15px; margin-right: 15px; }
        .status-item { display: flex; align-items: center; gap: 5px; }
        .timer-box { background: #fff; color: #dc3545; padding: 5px 12px; border-radius: 4px; font-weight: 700; font-family: monospace; font-size: 1.3rem; border: 1px solid #e0e0e0; display: flex; align-items: center; gap: 8px; }
        
        /* --- Layout --- */
        .exam-container { height: calc(100vh - 60px); display: flex; }
        .question-area { flex: 1; display: flex; flex-direction: column; height: 100%; position: relative; }
        .question-scroll-content { flex: 1; overflow-y: auto; padding: 30px 50px; scroll-behavior: smooth; background-color: #f4f6f8; padding-bottom: 100px; }
        
        .question-block { display: none; }
        .question-block.active { display: block; animation: fadeIn 0.3s ease-in-out; }
        .question-card { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); border: 1px solid #eaeaea; }
        .question-text { font-size: 1.2rem; color: #212529; line-height: 1.6; font-weight: 500; margin-bottom: 25px; }

        .nav-footer { height: 70px; background: white; border-top: 1px solid #e0e0e0; display: flex; align-items: center; justify-content: space-between; padding: 0 30px; box-shadow: 0 -2px 10px rgba(0,0,0,0.03); z-index: 5; }

        /* --- Sidebar --- */
        .sidebar { width: 340px; background: white; border-left: 1px solid #e0e0e0; display: flex; flex-direction: column; z-index: 10; }
        .accordion-button { padding: 10px 15px; font-size: 0.9rem; font-weight: 600; background-color: #f8f9fa; color: #495057; }
        .accordion-button:not(.collapsed) { color: #0056D2; background-color: #eef2ff; box-shadow: inset 0 -1px 0 rgba(0,0,0,.125); }
        .accordion-body { padding: 10px; background: #fff; }
        
        .palette-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        .palette-btn { width: 40px; height: 40px; border-radius: 4px; border: 1px solid #e0e0e0; background: #f8f9fa; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: 600; font-size: 14px; transition: all 0.2s; color: #495057; text-decoration: none; }
        .palette-btn:hover { background-color: #e9ecef; }
        
        .palette-btn.current { border-color: #0056D2; box-shadow: 0 0 0 2px #0056D2; z-index: 2; }
        .palette-btn.answered { background-color: #198754; color: white; border-color: #198754; }
        .palette-btn.review { background-color: #6610f2; color: white; border-color: #6610f2; }
        .palette-btn.review-answered { background-color: #6610f2; color: white; border-color: #6610f2; position: relative; }
        .palette-btn.review-answered::after { content: ''; position: absolute; bottom: 2px; right: 2px; width: 8px; height: 8px; background: #0dcaf0; border-radius: 50%; border: 1px solid #6610f2; }

        #fullscreen-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .stat-box { padding: 15px; border-radius: 8px; border: 1px solid; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div id="fullscreen-overlay">
        <div class="text-center">
            <div class="spinner-grow text-primary mb-4" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">Loading...</span>
            </div>
            <h2 class="fw-bold mb-3">Exam Environment Loaded</h2>
            <p class="text-muted mb-4">Click below to enter full-screen mode and start the timer.</p>
            
            <button class="btn btn-primary btn-lg rounded-pill px-5 shadow" onclick="enableFullScreen()">
                <i class="bi bi-arrows-fullscreen me-2"></i> Begin Assessment
            </button>
        </div>
    </div>

    <div class="exam-header">
        <div class="d-flex align-items-center">
            <span class="h5 mb-0 fw-bold text-primary me-3">Exam4Everybody</span>
            <div style="height: 25px; width: 1px; background: #e0e0e0; margin-right: 15px;"></div>
            <h6 class="mb-0 text-secondary d-none d-md-block">{{ test.item.title }}</h6>
        </div>
        
        <div class="d-flex align-items-center gap-3">
            <div class="system-status d-none d-lg-flex">
                <div class="status-item" title="Current Time"><span id="system-time">--:--</span></div>
                <div class="status-item" id="battery-status" title="Battery"><i class="bi bi-battery-full" id="battery-icon"></i><span id="battery-level">--%</span></div>
            </div>
            <button class="btn btn-outline-secondary btn-sm border-0" data-bs-toggle="modal" data-bs-target="#instructionsModal"><i class="bi bi-info-circle me-1"></i> Instructions</button>
            <div class="timer-box" id="timer"><i class="bi bi-stopwatch"></i> <span>00:00:00</span></div>
            <button type="button" class="btn btn-dark btn-sm fw-bold px-3" onclick="confirmSubmit()">Finish</button>
            <form id="submit-form" action="{% url 'submit_test' attempt.id %}" method="post" style="display:none;">{% csrf_token %}</form>
        </div>
    </div>

    <div class="exam-container">
        <div class="question-area">
            <div class="question-scroll-content" id="question-container">
                {% for section in sections %}
                    {% for question in section.questions.all %}
                    <div class="question-block" id="q-block-{{ question.id }}" data-section-id="{{ section.id }}" data-qid="{{ question.id }}">
                        
                        <div class="mb-3">
                            <span class="badge bg-light text-secondary border text-uppercase ls-1">{{ section.title }}</span>
                        </div>

                        <div class="question-card">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <span class="badge bg-primary bg-opacity-10 text-primary border border-primary-subtle px-3 py-2 rounded-pill">Question {{ forloop.counter }}</span>
                                <div class="d-flex gap-3 align-items-center">
                                    <span class="badge bg-light text-dark border">+{{ question.marks }} Marks</span>
                                    <button class="btn btn-link text-muted p-0" onclick="reportQuestion({{ question.id }})" title="Report"><i class="bi bi-flag"></i></button>
                                </div>
                            </div>
                            
                            <div class="question-text">{{ question.question_text|linebreaks }}</div>
                            
                            {% if question.images.all %}
                                <div class="row mb-4">
                                    {% for media in question.images.all %}
                                        <div class="col-md-12 text-center mb-3">
                                            <img src="{{ media.image.url }}" class="img-fluid rounded border" style="max-height: 300px;">
                                            {% if media.caption %}<p class="text-muted small fst-italic">{{ media.caption }}</p>{% endif %}
                                        </div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            
                            {% if question.audios.all %}
                                <div class="mb-4">
                                    {% for audio in question.audios.all %}
                                        <div class="bg-light p-2 rounded border mb-2">
                                            <small class="fw-bold d-block mb-1">{{ audio.label|default:"Audio Clip" }}</small>
                                            <audio controls class="w-100"><source src="{{ audio.audio_file.url }}" type="audio/mpeg"></audio>
                                        </div>
                                    {% endfor %}
                                </div>
                            {% endif %}

                            <div class="options-list">
                                {% for option in question.options.all %}
                                <div class="form-check mb-3 p-3 border rounded-3 bg-white d-flex align-items-start option-wrapper" style="cursor: pointer; transition: 0.2s;">
                                    <input class="form-check-input answer-input me-3 mt-1 flex-shrink-0" 
                                           type="radio" 
                                           name="question_{{ question.id }}" 
                                           id="opt_{{ option.id }}" 
                                           value="{{ option.id }}"
                                           data-qid="{{ question.id }}"
                                           style="transform: scale(1.3);">

                                    <label class="form-check-label w-100 cursor-pointer" for="opt_{{ option.id }}" style="line-height: 1.5;">
                                        {% if option.option_image %}
                                            <img src="{{ option.option_image.url }}" class="img-fluid rounded border mb-2 d-block" style="max-height: 120px;">
                                        {% endif %}
                                        {{ option.option_text }}
                                    </label>
                                </div>
                                {% endfor %}
                            </div>

                            <input type="checkbox" id="review_{{ question.id }}" style="display: none;">
                        </div>
                    </div>
                    {% endfor %}
                {% endfor %}
            </div>

            <div class="nav-footer">
                <div>
                    <button class="btn btn-outline-secondary me-2" id="btn-prev" onclick="navigate(-1)"><i class="bi bi-chevron-left"></i> Previous</button>
                    <button class="btn btn-outline-danger" onclick="clearCurrentResponse()">Clear</button>
                </div>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" id="current-review-chk">
                    <label class="form-check-label small fw-bold" for="current-review-chk">Review Later</label>
                </div>
                <button class="btn btn-primary px-4" id="btn-next" onclick="navigate(1)">Next <i class="bi bi-chevron-right"></i></button>
            </div>
        </div>

        <div class="sidebar">
            <div class="accordion accordion-flush flex-grow-1 overflow-y-auto" id="paletteAccordion">
                {% for section in sections %}
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button {% if not forloop.first %}collapsed{% endif %}" type="button" data-bs-toggle="collapse" data-bs-target="#section-collapse-{{ section.id }}">
                            {{ section.title }}
                        </button>
                    </h2>
                    <div id="section-collapse-{{ section.id }}" class="accordion-collapse collapse {% if forloop.first %}show{% endif %}" data-bs-parent="#paletteAccordion">
                        <div class="accordion-body">
                            <div class="palette-grid">
                                {% for question in section.questions.all %}
                                    <div class="palette-btn" id="palette-btn-{{ question.id }}" onclick="jumpToQuestion('{{ question.id }}', '{{ section.id }}')">{{ forloop.counter }}</div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="p-3 bg-light border-top small">
                <div class="d-flex justify-content-between mb-2">
                    <span><span class="badge bg-success rounded-circle p-1 me-1"> </span> Answered</span>
                    <span><span class="badge bg-secondary rounded-circle p-1 me-1"> </span> Unseen</span>
                </div>
                <div class="d-flex justify-content-between">
                    <span><span class="badge bg-primary rounded-circle p-1 me-1"> </span> Active</span>
                    <span><span class="badge rounded-circle p-1 me-1" style="background:#6610f2;"> </span> Review</span>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="submitSummaryModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header border-0 pb-0">
                    <h5 class="modal-title fw-bold text-dark">Exam Summary</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body pt-2">
                    <p class="text-muted mb-4">You are about to submit your test. Here is your status:</p>
                    <div class="row g-3 text-center mb-4">
                        <div class="col-4"><div class="stat-box bg-success bg-opacity-10 border-success"><h2 class="fw-bold text-success mb-0" id="summary-answered">0</h2><small class="text-success fw-bold">Answered</small></div></div>
                        <div class="col-4"><div class="stat-box" style="background-color: #f3ebff; border-color: #d0bfff; color: #6610f2;"><h2 class="fw-bold mb-0" id="summary-review">0</h2><small class="fw-bold">Review</small></div></div>
                        <div class="col-4"><div class="stat-box bg-danger bg-opacity-10 border-danger"><h2 class="fw-bold text-danger mb-0" id="summary-unanswered">0</h2><small class="text-danger fw-bold">Skipped</small></div></div>
                    </div>
                    <div id="review-warning" class="alert alert-warning small d-none"><i class="bi bi-exclamation-triangle-fill me-2"></i> <strong>Warning:</strong> You have questions marked for review.</div>
                    <div class="alert alert-light small border text-muted mb-0"><i class="bi bi-info-circle me-1"></i> Once submitted, you cannot change your answers.</div>
                </div>
                <div class="modal-footer border-0 bg-light">
                    <button type="button" class="btn btn-outline-secondary rounded-pill px-4 fw-semibold" data-bs-dismiss="modal">Keep Working</button>
                    <button type="button" class="btn btn-dark rounded-pill px-4 fw-bold shadow-sm" onclick="finalSubmit()">Yes, Submit Exam</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="instructionsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title fw-bold">Instructions</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
               <div class="modal-body">
    <div class="text-muted">
        {{ test.instructions|safe|linebreaks }}
    </div>
</div>
                <div class="modal-footer"><button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button></div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="reportModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title">Report Question</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body"><input type="hidden" id="report-qid"><textarea class="form-control" id="report-reason" rows="3" placeholder="Reason..."></textarea></div>
                <div class="modal-footer"><button type="button" class="btn btn-danger" onclick="submitReport()">Submit</button></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // FIX: Get token correctly
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        const savedAnswers = {{ answers_json|safe }};
        
        const allQuestionIds = [];
        {% for section in sections %}
            {% for q in section.questions.all %}
                allQuestionIds.push("{{ q.id }}");
            {% endfor %}
        {% endfor %}
        
        let currentIdx = 0;
        let isFullScreen = false;
        let submitModal = null;

        // --- Smart Event Listeners (No inline onclick) ---
        document.addEventListener("DOMContentLoaded", function() {
            submitModal = new bootstrap.Modal(document.getElementById('submitSummaryModal'));
            
            // 1. Restore State
            for (const [qid, data] of Object.entries(savedAnswers)) {
                if (data.selected_option_id) {
                    const radio = document.getElementById(`opt_${data.selected_option_id}`);
                    if (radio) radio.checked = true;
                }
                const hiddenChk = document.getElementById(`review_${qid}`);
                if (hiddenChk && data.is_marked_for_review) hiddenChk.checked = true;
                
                updatePaletteVisuals(qid, !!data.selected_option_id, data.is_marked_for_review);
            }
            showQuestionBlock(0);

            // 2. Attach Listeners to Radio Buttons (The Source of Truth)
            document.querySelectorAll('.answer-input').forEach(input => {
                input.addEventListener('change', function() {
                    const qid = this.dataset.qid;
                    // Update visuals
                    document.querySelectorAll(`input[name="question_${qid}"]`).forEach(el => {
                        el.closest('.option-wrapper').classList.remove('border-primary', 'bg-light');
                    });
                    this.closest('.option-wrapper').classList.add('border-primary', 'bg-light');
                    // Save
                    saveData(qid);
                });
            });

            // 3. Handle Div Clicks (Delegation) to trigger inputs
            document.querySelectorAll('.option-wrapper').forEach(wrapper => {
                wrapper.addEventListener('click', function(e) {
                    // If user clicked the label or input, browser handles it.
                    // If user clicked the padding (wrapper div), we need to manually check.
                    if (e.target !== this.querySelector('input') && e.target.tagName !== 'LABEL') {
                        const input = this.querySelector('input');
                        if (!input.checked) {
                            input.checked = true;
                            input.dispatchEvent(new Event('change')); // Trigger the change listener above
                        }
                    }
                });
            });
        });

        // --- Data Saving ---
        function saveData(qid) {
            const selectedOption = document.querySelector(`input[name="question_${qid}"]:checked`);
            const isReviewed = document.getElementById(`review_${qid}`).checked; // Read from hidden input
            
            updatePaletteVisuals(qid, !!selectedOption, isReviewed);

            fetch("{% url 'save_answer' %}", {
                method: "POST",
                headers: { "Content-Type": "application/json", "X-CSRFToken": csrfToken },
                body: JSON.stringify({
                    attempt_id: {{ attempt.id }},
                    question_id: qid,
                    option_id: selectedOption ? selectedOption.value : null,
                    is_reviewed: isReviewed
                })
            });
        }

        function updatePaletteVisuals(qid, isAnswered, isReviewed) {
            const btn = document.getElementById(`palette-btn-${qid}`);
            if(!btn) return;
            btn.className = 'palette-btn'; 
            if (qid === allQuestionIds[currentIdx]) btn.classList.add('current');
            if (isReviewed && isAnswered) btn.classList.add('review-answered');
            else if (isReviewed) btn.classList.add('review');
            else if (isAnswered) btn.classList.add('answered');
            
            // Also highlight option container if visible
            if(isAnswered) {
                const checked = document.querySelector(`input[name="question_${qid}"]:checked`);
                if(checked) checked.closest('.option-wrapper').classList.add('border-primary', 'bg-light');
            }
        }

        // --- Interaction & Nav ---
        document.getElementById('current-review-chk').addEventListener('change', function() {
            const qid = allQuestionIds[currentIdx];
            document.getElementById(`review_${qid}`).checked = this.checked; // Sync to hidden
            saveData(qid);
        });

        function clearCurrentResponse() {
            const qid = allQuestionIds[currentIdx];
            document.querySelectorAll(`input[name="question_${qid}"]`).forEach(r => {
                r.checked = false;
                r.closest('.option-wrapper').classList.remove('border-primary', 'bg-light');
            });
            saveData(qid);
        }

        function showQuestionBlock(index) {
            if (index < 0 || index >= allQuestionIds.length) return;
            document.querySelectorAll('.question-block').forEach(el => el.classList.remove('active'));
            
            const qid = allQuestionIds[index];
            const block = document.getElementById(`q-block-${qid}`);
            block.classList.add('active');
            currentIdx = index;

            document.getElementById('btn-prev').disabled = (index === 0);
            if (index === allQuestionIds.length - 1) {
                document.getElementById('btn-next').innerHTML = 'Submit <i class="bi bi-check-lg"></i>';
                document.getElementById('btn-next').className = "btn btn-success px-4";
            } else {
                document.getElementById('btn-next').innerHTML = 'Next <i class="bi bi-chevron-right"></i>';
                document.getElementById('btn-next').className = "btn btn-primary px-4";
            }

            document.querySelectorAll('.palette-btn').forEach(b => b.classList.remove('current'));
            const pBtn = document.getElementById(`palette-btn-${qid}`);
            if(pBtn) pBtn.classList.add('current');

            // Expand Accordion
            const sectionId = block.dataset.sectionId;
            const collapseEl = document.getElementById(`section-collapse-${sectionId}`);
            if (collapseEl && !collapseEl.classList.contains('show')) {
                const bsCollapse = new bootstrap.Collapse(collapseEl, { toggle: true });
            }

            // Sync Footer Review Checkbox
            const hiddenInput = document.getElementById(`review_${qid}`);
            document.getElementById('current-review-chk').checked = hiddenInput ? hiddenInput.checked : false;
        }

        function navigate(direction) {
            if (direction === 1 && currentIdx === allQuestionIds.length - 1) {
                confirmSubmit();
                return;
            }
            showQuestionBlock(currentIdx + direction);
        }

        function jumpToQuestion(qid, sectionId) {
            const idx = allQuestionIds.indexOf(qid);
            if (idx !== -1) showQuestionBlock(idx);
        }

        function confirmSubmit() {
            let answered = 0, review = 0, unanswered = 0;
            allQuestionIds.forEach(qid => {
                const isAnswered = document.querySelector(`input[name="question_${qid}"]:checked`);
                const hiddenInput = document.getElementById(`review_${qid}`);
                const isReviewed = hiddenInput ? hiddenInput.checked : false;
                if (isAnswered) answered++; else unanswered++;
                if (isReviewed) review++;
            });
            
            document.getElementById('summary-answered').innerText = answered;
            document.getElementById('summary-review').innerText = review;
            document.getElementById('summary-unanswered').innerText = unanswered;
            
            const reviewWarn = document.getElementById('review-warning');
            if (review > 0) reviewWarn.classList.remove('d-none');
            else reviewWarn.classList.add('d-none');
            submitModal.show();
        }

        function finalSubmit() { document.getElementById('submit-form').submit(); }

        // --- System Helpers ---
        function updateSystemTime() {
            document.getElementById('system-time').innerText = new Date().toLocaleTimeString('en-US', {hour: 'numeric', minute:'2-digit', hour12: true});
        }
        setInterval(updateSystemTime, 1000); updateSystemTime();

        function updateBatteryStatus() {
            if ('getBattery' in navigator) navigator.getBattery().then(b => {
                const update = () => {
                    const level = Math.round(b.level * 100);
                    document.getElementById('battery-level').innerText = level + "%";
                    document.getElementById('battery-icon').className = b.charging ? "bi bi-battery-charging text-success" : (level > 20 ? "bi bi-battery-full" : "bi bi-battery text-danger");
                };
                update(); b.addEventListener('levelchange', update); b.addEventListener('chargingchange', update);
            });
            else document.getElementById('battery-status').style.display = 'none';
        }
        updateBatteryStatus();

        function enableFullScreen() {
            const el = document.documentElement;
            if(el.requestFullscreen) el.requestFullscreen().then(() => {
                document.getElementById('fullscreen-overlay').style.display = 'none'; isFullScreen = true;
            }).catch(() => { document.getElementById('fullscreen-overlay').style.display = 'none'; });
            else document.getElementById('fullscreen-overlay').style.display = 'none';
        }

        // Timer
        let timeRemaining = {{ remaining_seconds }};
        const timerDisplay = document.querySelector('#timer span');
        
        // Helper to format time
        function formatTime(seconds) {
            const h = Math.floor(seconds / 3600).toString().padStart(2, '0');
            const m = Math.floor((seconds % 3600) / 60).toString().padStart(2, '0');
            const s = (seconds % 60).toString().padStart(2, '0');
            return `${h}:${m}:${s}`;
        }

        // Immediate initial render
        timerDisplay.innerText = formatTime(timeRemaining);

        setInterval(() => {
            if (!isFullScreen && timeRemaining > 0) return; 
            
            timeRemaining--;
            
            if (timeRemaining <= 0) {
                timeRemaining = 0;
                finalSubmit(); // Auto-submit when zero
            }
            
            timerDisplay.innerText = formatTime(timeRemaining);
        }, 1000);
    </script>
</body>
</html>